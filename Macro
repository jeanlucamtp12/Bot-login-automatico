Rem Attribute VBA_ModuleType=VBAModule
Option VBASupport 1
Dim HTMLDoc As HTMLDocument
Dim oBrowser As InternetExplorer
Declare Sub Sleep Lib "kernel32" _
(ByVal dwMilliseconds As Long)
Sub Login()
 
Dim oHTML_Element As IHTMLElement
Dim sURL As String
Dim Dc_URL As String
Dim Dc_Fonte As String

sURL = " "  'Link do site a ser acessado para realizaçãp de login
On Error GoTo Err_Clear
  
Set oBrowser = New InternetExplorer
   oBrowser.Silent = True
   oBrowser.timeout = 60
   oBrowser.navigate sURL
   oBrowser.Visible = True

Do
Loop Until oBrowser.readyState = READYSTATE_COMPLETE    'Espera a pagina carregar por completo para realizar o proximo passo

Set HTMLDoc = oBrowser.document

 HTMLDoc.all.Usuario.Value = ""    'Matricula do Usuario
 
 Sleep 1000   'Faz o código esperar por 1 segundo
 
 HTMLDoc.all.senha.Value = ""       'Senha do Usuario

 Sleep 1000   'Faz o código esperar por 1 segundo
 HTMLDoc.all.Login.Click                 'Assiona o botão 'Entrar no sistema'
  
Dc_URL = " "     'Opcional, caso deseje abrir outra pagina apos o login'
oBrowser.Navigate2 Dc_URL

Do
Loop Until oBrowser.readyState = READYSTATE_COMPLETE
SendKeys "^u"

For Each oHTML_Element In HTMLDoc.getElementsByTagName("input")
    If oHTML_Element.Type = "submit" Then oHTML_Element.Click: Exit For

Next
Err_Clear:
Resume Next
End Sub
